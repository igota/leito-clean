{% extends "base.html" %}

{% block content %}
    <title>Gerenciar Usu√°rios</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/paginaUsuarios.css') }}">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  
</head>
<body>

<div class="container">
    <h2 class="titulo-pagina">Gerenciamento de Usu√°rios</h2>

    <!-- üîç Filtros -->
    <div class="card mb-4">
        <div class="card-body">
            <form id="formBusca" class="row g-3">
                <div class="col-md-4">
                    <label class="form-label">Nome</label>
                    <input type="text" id="nomeBusca" class="form-control" placeholder="Digite o nome...">
                </div>
                <div class="col-md-4">
                    <label class="form-label">ID Cart√£o</label>
                    <input type="text" id="idCartaoBusca" class="form-control" placeholder="Digite o ID Cart√£o...">
                </div>
                <div class="col-md-3">
                    <label class="form-label">Tipo</label>
                    <select id="tipoBusca" class="form-select">
                        <option value="">Todos</option>
                        <option value="limpeza">Limpeza</option>
                        <option value="tecnico">T√©cnico de Enfermagem</option>
                        
                    </select>
                </div>
                  <div class="botoes">
                      <button type="submit" class="btn btn-primary w-100">
                          <i class="bi bi-search"></i> Buscar
                      </button>
                      <button type="button" class="btn btn-outline-danger w-100" onclick="limparConsulta()">
                          <i class="bi bi-x-circle"></i> Limpar
                      </button>
                      <button type="button"   class="btn btn-success w-100" data-bs-toggle="modal" data-bs-target="#modalCadastro">+ Novo Usu√°rio</button>
                      
                  </div>


            </form>
        </div>
    </div>



    <!-- üìã Tabela -->
    <table class="table table-striped table-bordered" id="tabelaUsuarios">
        <thead class="table-dark">
            <tr>
                
                <th>Nome</th>
                <th>CPF</th>
                <th>ID CART√ÉO</th>
                <th>Tipo</th>
                <th>Status</th>
                <th></th>
                
            </tr>
        </thead>
        <tbody></tbody>
    </table>

    

</div>

<!-- ü™ü Modal de Cadastro -->
<div class="modal fade" id="modalCadastro" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">

      <div class="modal-header">
        <h5 class="modal-title">Cadastrar Novo Usu√°rio</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
      </div>

      <div class="modal-body">
        <!-- ‚úÖ onsubmit agora impede reload e chama salvarUsuario(event) -->
        <form id="formCadastro" onsubmit="salvarUsuario(event)">
          <div class="mb-3">
            <label class="form-label">Nome</label>
            <input type="text" id="nome" class="form-control" required>
          </div>

          <div class="mb-3">
            <label class="form-label">CPF</label>
            <input type="text" id="cpf" class="form-control" maxlength="14" placeholder="000.000.000-00" required>
          </div>

          <div class="mb-3">
            <label class="form-label">ID Cart√£o</label>
            <input id="id_cartao" class="form-control" maxlength="10" required>
          </div>

          <div class="mb-3">
            <label class="form-label">Tipo</label>
            <select id="tipo" class="form-select" required>
              <option value="">Selecione...</option>
              <option value="limpeza">Limpeza</option>
              <option value="tecnico">T√©cnico de Enfermagem</option>
            </select>
          </div>

          <!-- ‚úÖ Bot√µes dentro do form -->
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
            <button type="submit" class="btn btn-primary">Salvar</button>
          </div>
        </form>
      </div>

    </div>
  </div>
</div>



<!-- ü™ü Modal de Edi√ß√£o -->
<div class="modal fade" id="modalEditar" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Editar Usu√°rio</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <form id="formEditar">
          <!-- üîî Alerta din√¢mico -->
          <div id="alertContainer" style="display:none;" class="alert alert-danger py-2"></div>

          <input type="hidden" id="editId">

          <div class="mb-3">
            <label class="form-label">Nome</label>
            <input type="text" id="editNome" class="form-control" required>
          </div>
          <div class="mb-3">
            <label class="form-label">CPF</label>
            <input type="text" id="editCpf" class="form-control" maxlength="14">
          </div>
          <div class="mb-3">
            <label class="form-label">ID Cart√£o</label>
            <input id="editIdcartao" class="form-control" maxlength="10" required>
          </div>
          <div class="mb-3">
            <label class="form-label">Tipo</label>
            <select id="editTipo" class="form-select" required>
              <option value="">Selecione...</option>
              <option value="limpeza">Limpeza</option>
              <option value="tecnico">T√©cnico de Enfermagem</option>
            </select>
          </div>
          <div class="mb-3">
            <label class="form-label d-block">Status</label>
            <div class="form-check form-check-inline">
              <input class="form-check-input" type="radio" name="editAtivo" id="editAtivo1" value="1">
              <label class="form-check-label" for="editAtivo1">Ativo</label>
            </div>
            <div class="form-check form-check-inline">
              <input class="form-check-input" type="radio" name="editAtivo" id="editAtivo0" value="0">
              <label class="form-check-label" for="editAtivo0">Inativo</label>
            </div>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
        <button class="btn btn-primary" onclick="salvarEdicao()">Salvar Altera√ß√µes</button>
      </div>
    </div>
  </div>
</div>


<script src="{{ url_for('static', filename='js/paginaUsuarios.js') }}"></script>

<!-- Container para os Toasts -->

<div id="toastContainer" class="position-fixed top-50 start-50 translate-middle p-3" style="z-index: 2000;"></div>


</body>

{% endblock %}